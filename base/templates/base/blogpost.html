{% extends 'main.html' %} {% load static %} {% block content %}
<div class="px-4 lg:px-8 max-w-7xl mx-auto flex flex-col justify-between gap-6">
  <div class="flex justify-between">
    <div
      class="bg-teal-900 py-2 px-4 rounded-full flex items-center text-white gap-4"
    >
      <a
        id="back-button"
        class="inline-block px-2 py-1 font-bold hover:bg-yellow-300 hover:text-black rounded-full transition-all duration-300"
        href="#"
        >&larr;</a
      >
      Retourner
    </div>
    <span
      class="flex items-center gap-4 py-2 px-4 rounded-full bg-yellow-200 text-black"
      ><i class="fa-solid fa-newspaper"></i>{{ curr_obj.title }}</span
    >
  </div>

  <!--------------------------------------- blogpost layout --------------------------------------->

  <section class="grid lg:flex lg:flex-row items-start gapy-4">
    <!--------------------- current blogpost -------------------------->

    <div class="mb-8 relative bg-white border rounded-xl flex flex-col w-full">
      {% if user.is_staff %}
      <div class="absolute right-4 top-4 text-xs w-fit text-gray-700">
        <button
          type="button"
          class="bg-white hover:text-teal-600 px-3 py-1 rounded-full transition ease-in duration-200"
          name="sentry"
          onclick="toggleMenu(this,'blg_{{curr_obj.id}}')"
        >
          <i class="fa-sharp fa-solid fa-ellipsis"></i>
        </button>

        <div
          class="hidden z-30 bg-gray-50 w-40 shadow-md lg:w-[180px] p-2 absolute right-4 top-8 origin-top-left bg-white z-10 rounded-lg flex flex-col items-center gap-2 text-xs overflow-hidden"
          id="blg_{{curr_obj.id}}"
        >
          <a
            onclick="hide_dialogs()"
            hx-target="#basic_dialog"
            hx-get="{% url 'edit_blogpost' curr_obj.id %}"
            class="px-4 py-2 flex items-center hover:text-black hover:bg-green-200 rounded-full w-full text-center cursor-pointer"
            ><i class="fa-solid fa-pen-to-square mr-2"></i>
            Modifier
          </a>

          <button
            hx-confirm="Voulez vous vraiment supprimer ceci?"
            hx-delete="{% url 'delete_base_object' curr_obj.id 'Blogpost' %}"
            class="px-4 py-2 flex items-center hover:text-black hover:bg-red-200 rounded-full w-full text-center cursor-pointer"
          >
            <i class="fa-solid fa-trash mr-2"></i>
            Supprimer
          </button>
        </div>
      </div>
      {% endif %}
      <!--  -->
      {% if not curr_obj.image %}
      <img
        class="h-80 w-full rounded-t-md object-cover"
        src="{% static 'imgs/banner_1.webp' %}"
        alt="blogpost image"
      />
      {% else %}
      <img
        class="h-80 w-full rounded-t-md object-cover"
        src="{{curr_obj.image.url}}"
        alt="blogpost image"
      />
      {% endif %}

      <div class="p-4 lg:p-6 flex flex-col gap-4">
        <article class="flex flex-col gap-2 pt-2">
          <h4 class="text-black text-3xl font-bold">{{curr_obj.title}}</h4>
          <p class="text-lg">{{curr_obj.subtitle}}</p>
          <small class="text-xs italic">{{curr_obj.timestamp}}</small>
          <p
            class="text-md text-gray-800 overflow-wrap:break-word word-break:break-all"
          >
            {{curr_obj.content|safe}}
          </p>
        </article>

        <hr />
        <div
          class="grid gap-2"
          hx-get="{% url 'blogpost_info' curr_obj.id %}"
          hx-trigger="load, db_changed from:body"
          hx-target="this"
        >
          <p
            class="h-full w-full flex justify-center items-center text-teal-500 p-4"
          >
            <i class="m-auto fas fa-spinner fa-spin text-3xl animate-spin"></i>
          </p>
        </div>
      </div>
    </div>

    <!--------------------------------------- other blogposts --------------------------------------->
    <div
      class="w-full lg:w-[500px] grid md:grid-cols-2 lg:grid-cols-1 gap-4 mt-6 lg:mt-0 lg:ml-6"
    >
      {% for obj in blogposts %}
      <!--  -->
      {% include 'base/components/blog_card_alt.html' %}
      <!--  -->
      {% endfor %}
    </div>
  </section>
</div>

{% endblock %}
